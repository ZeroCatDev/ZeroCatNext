import{_ as V,h as u,o as m,c as y,w as s,a,C as _,p as l,m as d,e as g,y as C,F as x,q as v,s as $,U as k,v as p,R as P,a0 as O,j as L,z as h,a1 as b,D as T,E as w,X as N,Y as B}from"./index-C00Q7nfi.js";import{V as D}from"./VContainer-CQyzLSBT.js";const E={data(){return{totpList:[],loading:!1,renameDialog:!1,deleteDialog:!1,selectedTOTPId:null,newName:"",renameError:"",nameRules:[t=>t?!0:"Name is required.",t=>(t==null?void 0:t.length)<=100?!0:"Name must be less than 10 characters."]}},methods:{async fetchTOTPList(){this.loading=!0;try{const t=await u.get("/account/totp/list");t.status==="success"?this.totpList=t.data.list:this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}catch(t){this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}finally{this.loading=!1}},async renameTOTP(t,e){if(e==""){this.renameError="名称不能为空";return}try{const i=await u.post("/account/totp/rename",{totp_id:t,name:e});i.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"验证器重命名成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}catch(i){this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}},async deleteTOTP(t){try{const e=await u.post("/account/totp/delete",{totp_id:t});e.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"验证器删除成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}catch(e){this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}}},mounted(){this.fetchTOTPList()}},R={class:"headline"};function q(t,e,i,F,c,f){return m(),y(D,null,{default:s(()=>[a(d,{to:"./totp/add",color:"primary",class:"mb-4"},{default:s(()=>[a(_,{left:""},{default:s(()=>e[0]||(e[0]=[l("mdi-plus")])),_:1}),e[1]||(e[1]=l("新的验证器 "))]),_:1}),a(v,null,{default:s(()=>[(m(!0),g(x,null,C(c.totpList,r=>(m(),y($,{key:r.id,cols:"12",md:"4"},{default:s(()=>[a(k,{"max-width":"500"},{activator:s(({props:n})=>[a(p,P({border:"",ref_for:!0},n),{default:s(()=>[a(O,null,{default:s(()=>[L("span",R,h(r.name),1)]),_:2},1024),a(b,null,{default:s(()=>[l(h(r.status),1)]),_:2},1024),a(T,null,{default:s(()=>e[2]||(e[2]=[l(" 点击打开管理 ")])),_:1})]),_:2},1040)]),default:s(({isActive:n})=>[a(p,{title:r.name,border:""},{default:s(()=>[a(T,null,{default:s(()=>[a(w,{modelValue:r.name,"onUpdate:modelValue":o=>r.name=o,counter:100,rules:c.nameRules,label:"验证器名称",required:""},null,8,["modelValue","onUpdate:modelValue","rules"]),a(d,{color:"primary",onClick:o=>f.renameTOTP(r.id,r.name)},{default:s(()=>e[3]||(e[3]=[l("重命名")])),_:2},1032,["onClick"])]),_:2},1024),a(N,null,{default:s(()=>[a(d,{color:"error",variant:"text",onClick:o=>f.deleteTOTP(r.id),border:""},{default:s(()=>e[4]||(e[4]=[l("删除")])),_:2},1032,["onClick"]),a(B),a(d,{text:"关闭",onClick:o=>n.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}const U=V(E,[["render",q]]);export{U as default};
