import{J as v,a5 as P,ac as O,M as g,S as _,a,_ as k,h as l,r as L,o as m,c as f,w as s,s as y,m as c,p as o,Z as $,e as C,y as V,F as w,q as x,x as I,ax as B,z as T,ay as A,W as u}from"./index-BM7Y0EbS.js";import{V as F}from"./VContainer-Dahcg1I7.js";const N=v({start:Boolean,end:Boolean,...P(),...O()},"VListItemAction"),S=g()({name:"VListItemAction",props:N(),setup(t,e){let{slots:i}=e;return _(()=>a(t.tag,{class:["v-list-item-action",{"v-list-item-action--start":t.start,"v-list-item-action--end":t.end},t.class],style:t.style},i)),{}}}),b={data(){return{totpList:[]}},methods:{async fetchTOTPList(){try{const t=await l.get("/totp/list");t.status==="success"?this.totpList=t.data.list:this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}catch(t){this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}},async renameTOTP(t){const e=prompt("请输入新的名称");if(e)try{const i=await l.post("/totp/rename",{totpId:t,name:e});i.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"TOTP验证器重命名成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}catch(i){this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}},async deleteTOTP(t){try{const e=await l.post("/totp/delete",{totpId:t});e.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"TOTP验证器删除成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}catch(e){this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}},async generateTOTP(){try{const t=await l.post("/totp/generate");t.status==="success"?(this.$toast.add({severity:"success",summary:"成功",detail:`新的TOTP验证器已生成: ${t.data.secret}`,life:3e3}),this.fetchTOTPList()):this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}catch(t){this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}},async activateTOTP(t){const e=prompt("请输入TOTP令牌");if(e)try{const i=await l.post("/totp/activate",{totpId:t,totpToken:e});i.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"TOTP验证器激活成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}catch(i){this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}}},mounted(){this.fetchTOTPList()}};function M(t,e,i,R,p,n){const h=L("v-list-item-content");return m(),f(F,null,{default:s(()=>[a(x,null,{default:s(()=>[a(y,{cols:"12"},{default:s(()=>[a(c,{onClick:n.generateTOTP,color:"primary",class:"mb-4"},{default:s(()=>e[0]||(e[0]=[o("生成新的TOTP验证器")])),_:1},8,["onClick"])]),_:1}),a(y,{cols:"12"},{default:s(()=>[a($,null,{default:s(()=>[(m(!0),C(w,null,V(p.totpList,r=>(m(),f(I,{key:r.id,onClick:d=>t.selectTOTP(r)},{default:s(()=>[a(h,null,{default:s(()=>[a(B,null,{default:s(()=>[o(T(r.name),1)]),_:2},1024),a(A,null,{default:s(()=>[o(T(r.status),1)]),_:2},1024)]),_:2},1024),a(S,null,{default:s(()=>[a(c,{onClick:u(d=>n.renameTOTP(r.id),["stop"]),color:"info"},{default:s(()=>e[1]||(e[1]=[o("重命名")])),_:2},1032,["onClick"]),a(c,{onClick:u(d=>n.deleteTOTP(r.id),["stop"]),color:"error"},{default:s(()=>e[2]||(e[2]=[o("删除")])),_:2},1032,["onClick"]),a(c,{onClick:u(d=>n.activateTOTP(r.id),["stop"]),color:"success"},{default:s(()=>e[3]||(e[3]=[o("激活")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const D=k(b,[["render",M]]);export{D as default};
