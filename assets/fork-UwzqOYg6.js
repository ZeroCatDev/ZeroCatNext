import{_ as h,o as f,c as y,w as o,a as r,q as j,a2 as g,a0 as x,l as a,v as u,a1 as k,s as w,h as i,r as v,E as V,j as b,x as l,z as $,az as _}from"./index-DR8AH6H4.js";import{_ as C}from"./43-lazyload-CBkwrR6M.js";import{V as z}from"./VContainer-cpvgTsgK.js";const R={data(){return{project:{},projectfile:{},newid:"",openEditor:_,localuser:$,checktext:"",checkknow:!1,checklicense:!1,scratch_proxy:"https://scratch.192325.xyz",textRules:[e=>e?!0:"记得输入内容哦~",e=>{if(e!="我保证会好好对待改编的作品")return"输的不太对~"}]}},async created(){await this.getproject()},methods:{async getproject(){this.project=await l({url:this.scratch_proxy+"/projects/"+this.$route.params.id,method:"get"}),console.log(this.project)},async forkproject(e){await l({url:"/project/"+e+"/fork",method:"post"}).then(t=>{console.log(t),this.$toast.add({severity:"success",summary:"成功",detail:"分叉成功",life:3e3}),t.id&&this.$router.push("/projects/"+t.id)}).catch(t=>{console.log(t),this.$toast.add({severity:"error",summary:"错误",detail:t,life:3e3})})},async getProjectFile(){try{await this.getproject();const e=await l({url:`${this.scratch_proxy}/projects/source/${this.$route.params.id}?token=${this.project.project_token}`,method:"get"});console.log(e),this.$toast.add({severity:"success",summary:"成功",detail:"获取项目文件成功",life:3e3}),this.projectfile=e;const t=await l.post("/project/",{title:this.project.title,type:"scratch",state:"public"});if(console.log(t),this.$toast.add({severity:"info",summary:"信息",detail:t,life:3e3}),t.status==="1"){this.newid=t.id;const n=await l.put(`/project/${this.newid}/source`,this.projectfile);console.log(n),this.$toast.add({severity:"info",summary:"信息",detail:n,life:3e3});const c=await l.post(`/project/${this.newid}/push`);console.log(c),this.$toast.add({severity:"info",summary:"信息",detail:c,life:3e3})}}catch(e){console.error(e),this.$toast.add({severity:"error",summary:"错误",detail:"操作失败，请稍后再试",life:3e3})}}}};function F(e,t,n,c,s,p){const m=v("v-text");return f(),y(z,{class:"pa-md-12"},{default:o(()=>[r(w,{style:{"aspect-ratio":"4/3"},rounded:"lg"},{default:o(()=>[r(j,{src:"https://scratch.192325.xyz/thumbnails/"+s.project.id,class:"align-end","lazy-src":C,height:"100%",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",cover:""},{default:o(()=>[r(g,null,{default:o(()=>[r(x,null,{default:o(()=>[a(u(s.project.title),1)]),_:1}),r(k,null,{default:o(()=>[a(u(s.project.description),1)]),_:1})]),_:1})]),_:1},8,["src"])]),_:1}),t[3]||(t[3]=i("br",null,null,-1)),r(m,null,{default:o(()=>t[2]||(t[2]=[a("如果您已了解以上内容，请在下方的输入框中输入")])),_:1}),t[4]||(t[4]=a()),t[5]||(t[5]=i("br",null,null,-1)),t[6]||(t[6]=i("br",null,null,-1)),r(V,{hint:"请准确输入上方的话",label:"我保证会好好对待改编的作品",type:"input",modelValue:s.checktext,"onUpdate:modelValue":t[0]||(t[0]=d=>s.checktext=d),rules:s.textRules,required:"",variant:"outlined",clearable:""},null,8,["modelValue","rules"]),t[7]||(t[7]=i("br",null,null,-1)),r(b,{class:"text-none",color:"primary",rounded:"xl",text:"Fork",variant:"flat",size:"large",onClick:t[1]||(t[1]=d=>p.getProjectFile(s.project.id)),"append-icon":"mdi-arrow-right",disabled:!s.checktext},null,8,["disabled"])]),_:1})}const P=h(R,[["render",F]]);export{P as default};
