import{_ as h}from"./LoadingDialog-B5sacSsV.js";import{_ as y,H as v,G as d,I as _,r as V,o as C,e as k,K as i,a as e,w as s,P as p,Q as a,a2 as m,M as l,O as c,T as R,W as b}from"./index-DGh90Ang.js";import"https://static.geetest.com/v4/gt4.js";import{i as g,g as f,r as z}from"./useRecaptcha-D4VPpSaq.js";import{u as B}from"./vue.8fc199ce-Cv1XXqEr.js";import{V as L}from"./VForm-CjVhl4tx.js";const N={components:{LoadingDialog:h},setup(){B({title:"ZeroCat - Login",meta:[{name:"description",content:"Login to your ZeroCat account."},{name:"keywords",content:"ZeroCat, login, account"}]})},data(){return{BASE_API:"https://zerocat-api.houlangs.com",username:"",password:"",tryinguser:{},loading:!1,initRecaptcha:g,getResponse:f,resetCaptcha:z,show1:v(!1),emailRules:[r=>r?!0:"必须填写邮箱",r=>/.+@.+\..+/.test(r)?!0:"不符合格式"],usernameRules:[r=>r?!0:"必须填写用户名"]}},created(){d.islogin.value==!0&&this.$router.push("/")},setup(){g("recaptcha-div","float")},methods:{async login(){if(this.loading=!0,this.tryinguser=await _({url:"/account/login",method:"post",data:{captcha:f(),un:this.username,pw:this.password}}),this.tryinguser.message!="OK"){this.loading=!1,this.$toast.add({severity:"info",summary:"info",detail:this.tryinguser.msg||this.tryinguser.message,life:3e3});return}this.loading=!1,d.setuser(this.tryinguser.token),console.log(this.tryinguser),(this.tryinguser.msg||this.tryinguser.message=="OK")&&this.$router.push("/")},addtoast(r){this.$toast.add({severity:"info",summary:"info",detail:r,life:3e3})}}},Z={class:"auth-wrapper d-flex align-center justify-center pa-4"};function F(r,t,I,K,o,x){const u=V("v-cardtext"),w=h;return C(),k(b,null,[i("div",Z,[e(R,{class:"auth-card pa-4 pt-7","max-width":"448",border:""},{default:s(()=>[e(p,null,{default:s(()=>[e(a,{cols:"12"},{default:s(()=>[e(u,null,{default:s(()=>t[4]||(t[4]=[i("h5",{class:"text-h5 font-weight-semibold mb-1"}," 欢迎来到ZeroCatNext！ 👋🏻 ",-1),i("p",{class:"mb-0"},"登录你的账户",-1)])),_:1})]),_:1})]),_:1}),e(u,null,{default:s(()=>[e(L,null,{default:s(()=>[e(p,null,{default:s(()=>[e(a,{cols:"12"},{default:s(()=>[e(m,{label:"邮箱",type:"text",modelValue:o.username,"onUpdate:modelValue":t[0]||(t[0]=n=>o.username=n),variant:"outlined",rules:o.emailRules},null,8,["modelValue","rules"]),e(m,{label:"密码",modelValue:o.password,"onUpdate:modelValue":t[1]||(t[1]=n=>o.password=n),variant:"outlined",rules:o.usernameRules,"append-icon":o.show1?"mdi-eye":"mdi-eye-off",type:o.show1?"text":"password","onClick:append":t[2]||(t[2]=n=>o.show1=!o.show1)},null,8,["modelValue","rules","append-icon","type"])]),_:1}),e(a,{cols:"9"},{default:s(()=>t[5]||(t[5]=[i("div",{id:"recaptcha-div"},null,-1)])),_:1}),e(a,{cols:"3"},{default:s(()=>[e(l,{onClick:t[3]||(t[3]=n=>o.resetCaptcha()),variant:"text"},{default:s(()=>t[6]||(t[6]=[c("刷新")])),_:1})]),_:1}),e(a,{cols:"12"},{default:s(()=>[e(l,{class:"text-none",color:"primary",rounded:"xl",text:"登录",variant:"flat",size:"large",onClick:x.login,"append-icon":"mdi-arrow-right"},null,8,["onClick"])]),_:1}),e(a,{cols:"12"},{default:s(()=>[e(l,{class:"text-none",color:"white",rounded:"xl",text:"注册",variant:"text",size:"large","append-icon":"mdi-arrow-right",to:"/account/register"}),t[7]||(t[7]=c()),e(l,{class:"text-none",color:"white",rounded:"xl",text:"邮箱验证登录",variant:"text",size:"large","append-icon":"mdi-arrow-right",to:"/account/magiclink"}),e(l,{class:"text-none",color:"white",rounded:"xl",text:"找回密码",variant:"text",size:"large","append-icon":"mdi-arrow-right",to:"/account/retrieve"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),e(w,{show:o.loading,text:"登录中"},null,8,["show"])],64)}const P=y(N,[["render",F]]);export{P as default};
